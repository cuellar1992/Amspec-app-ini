import{_ as Y}from"./PageBreadcrumb.vue_vue_type_script_setup_true_lang-CpoPOzAJ.js";import{c as N,_ as K}from"./AdminLayout.vue_vue_type_script_setup_true_lang-D4scmcBy.js";import{_ as J}from"./ComponentCard.vue_vue_type_script_setup_true_lang-B4SXyZ5T.js";import{u as T}from"./userService-UF_eJmhu.js";import{T as Q}from"./trash-2-CP7vxuEJ.js";import{d as V,r as b,K as B,o as X,a as i,b as m,e,F as ee,i as te,t as C,n as A,f as p,u as y,l as E,x as F,c as I,p as v,g as U,I as G,w as D,z as L,L as R,k as Z,h as W}from"./index-BDXnSKSk.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Y as P,h as z,G as q,V as H,S as O}from"./transition-DniDJg0f.js";/**
 * @license lucide-vue-next v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=N("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-vue-next v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=N("user-minus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-vue-next v0.552.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=N("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),le={class:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03]"},ne={class:"max-w-full overflow-x-auto custom-scrollbar"},de={class:"min-w-full"},ie={class:"divide-y divide-gray-200 dark:divide-gray-700"},ue={key:0},ce={key:1},ge={class:"px-5 py-4 sm:px-6"},pe={class:"flex items-center gap-3"},me={class:"w-10 h-10 rounded-full bg-brand-500 flex items-center justify-center flex-shrink-0 overflow-hidden"},fe=["src","alt"],ye={key:1,class:"text-white text-sm font-semibold"},ve={class:"block font-medium text-gray-800 text-theme-sm dark:text-white/90"},xe={class:"block text-gray-500 text-theme-xs dark:text-gray-400"},be={class:"px-5 py-4 sm:px-6"},he={class:"px-5 py-4 sm:px-6"},ke={class:"px-5 py-4 sm:px-6"},we={class:"text-gray-500 text-theme-sm dark:text-gray-400"},_e={class:"px-5 py-4 sm:px-6"},$e={class:"flex items-center gap-2"},Ce=["onClick"],Ue=["onClick","title"],Me=["onClick"],Ae=V({__name:"UsersManagementTable",props:{refreshTrigger:{}},emits:["edit","toggleStatus","delete"],setup(S,{expose:M}){const $=S,_=b([]),w=b(!1),a=l=>{if(!l)return"Never";const d=new Date(l),n=new Date().getTime()-d.getTime(),t=Math.floor(n/6e4),r=Math.floor(n/36e5),c=Math.floor(n/864e5);return t<60?`${t} minutes ago`:r<24?`${r} hours ago`:c<7?`${c} days ago`:d.toLocaleDateString()},k=l=>{if(!l||!l.trim())return"U";const d=l.trim().split(/\s+/);if(d.length===0)return"U";if(d.length===1)return d[0].substring(0,2).toUpperCase();const s=d[0],n=d[d.length-1];return(s.charAt(0)+n.charAt(0)).toUpperCase()},u=l=>l.isActive?"Active":"Inactive",x=l=>l.charAt(0).toUpperCase()+l.slice(1),f=async()=>{w.value=!0;try{const l=await T.getAllUsers();_.value=l||[]}catch(l){console.error("Error loading users:",l),_.value=[]}finally{w.value=!1}};return B(()=>$.refreshTrigger,()=>{$.refreshTrigger&&f()}),X(()=>{f()}),M({refresh:f}),(l,d)=>(i(),m("div",le,[e("div",ne,[e("table",de,[d[2]||(d[2]=e("thead",null,[e("tr",{class:"border-b border-gray-200 dark:border-gray-700"},[e("th",{class:"px-5 py-3 text-left w-3/11 sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"User")]),e("th",{class:"px-5 py-3 text-left w-2/11 sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Role")]),e("th",{class:"px-5 py-3 text-left w-2/11 sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Status")]),e("th",{class:"px-5 py-3 text-left w-2/11 sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Last Login")]),e("th",{class:"px-5 py-3 text-left w-1/11 sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Actions")])])],-1)),e("tbody",ie,[w.value?(i(),m("tr",ue,d[0]||(d[0]=[e("td",{colspan:"5",class:"px-5 py-8 text-center"},[e("div",{class:"flex items-center justify-center"},[e("div",{class:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-brand-500 border-r-transparent"}),e("span",{class:"ml-3 text-gray-500 dark:text-gray-400"},"Loading users...")])],-1)]))):_.value.length===0?(i(),m("tr",ce,d[1]||(d[1]=[e("td",{colspan:"5",class:"px-5 py-8 text-center"},[e("p",{class:"text-gray-500 dark:text-gray-400"},"No users found")],-1)]))):(i(!0),m(ee,{key:2},te(_.value,s=>(i(),m("tr",{key:s._id,class:"border-t border-gray-100 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[e("td",ge,[e("div",pe,[e("div",me,[s.avatar?(i(),m("img",{key:0,src:s.avatar,alt:s.name,class:"w-full h-full object-cover"},null,8,fe)):(i(),m("span",ye,C(k(s.name)),1))]),e("div",null,[e("span",ve,C(s.name||s.email),1),e("span",xe,C(s.email),1)])])]),e("td",be,[e("span",{class:A(["rounded-full px-2 py-0.5 text-theme-xs font-medium",{"bg-blue-50 text-blue-700 dark:bg-blue-500/15 dark:text-blue-500":s.role==="admin","bg-purple-50 text-purple-700 dark:bg-purple-500/15 dark:text-purple-500":s.role==="viewer","bg-gray-50 text-gray-700 dark:bg-gray-500/15 dark:text-gray-400":s.role==="user"}])},C(x(s.role)),3)]),e("td",he,[e("span",{class:A(["rounded-full px-2 py-0.5 text-theme-xs font-medium",{"bg-success-50 text-success-700 dark:bg-success-500/15 dark:text-success-500":u(s)==="Active","bg-error-50 text-error-700 dark:bg-error-500/15 dark:text-error-500":u(s)==="Inactive"}])},C(u(s)),3)]),e("td",ke,[e("p",we,C(a(s.lastLogin)),1)]),e("td",_e,[e("div",$e,[e("button",{onClick:n=>l.$emit("edit",s),class:"rounded-lg p-1.5 text-gray-600 hover:bg-gray-100 hover:text-gray-900 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white transition-all",title:"Edit user"},[p(y(ae),{class:"h-4 w-4"})],8,Ce),e("button",{onClick:n=>l.$emit("toggleStatus",s),class:A(["rounded-lg p-1.5 transition-all",s.isActive?"text-orange-600 hover:bg-orange-50 hover:text-orange-700 dark:text-orange-400 dark:hover:bg-orange-900/20":"text-green-600 hover:bg-green-50 hover:text-green-700 dark:text-green-400 dark:hover:bg-green-900/20"]),title:s.isActive?"Deactivate user":"Activate user"},[s.isActive?(i(),E(y(se),{key:0,class:"h-4 w-4"})):(i(),E(y(oe),{key:1,class:"h-4 w-4"}))],10,Ue),e("button",{onClick:n=>l.$emit("delete",s),class:"rounded-lg p-1.5 text-red-600 hover:bg-red-50 hover:text-red-700 dark:text-red-400 dark:hover:bg-red-900/20 transition-all",title:"Delete user"},[p(y(Q),{class:"h-4 w-4"})],8,Me)])])]))),128))])])])]))}}),Se=re(Ae,[["__scopeId","data-v-a95f2670"]]),je={class:"fixed inset-0 overflow-y-auto"},De={class:"flex min-h-full items-center justify-center p-4"},ze={class:"flex items-center justify-between border-b border-gray-200 dark:border-gray-700 px-6 py-4 bg-gradient-to-r from-brand-50 to-white dark:from-gray-800 dark:to-gray-800"},Te={class:"space-y-4"},Ee={class:"relative"},Be=["type"],Le={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ve={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ne={key:0,class:"mt-2"},Fe={class:"flex items-center gap-2 mb-1"},Pe={class:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden dark:bg-gray-700"},qe={key:1,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},He={key:0,class:"rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 px-4 py-3"},Oe={class:"text-sm text-red-800 dark:text-red-300"},Ie={class:"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700"},Ge=["disabled"],Re={key:0,class:"flex items-center gap-2"},Ze={key:1},We=V({__name:"AddUserModal",props:{isOpen:{type:Boolean}},emits:["close","created"],setup(S,{emit:M}){const $=S,_=M,w=F(),a=b({username:"",password:"",name:""}),k=b(!1),u=b(""),x=b(!1);B(()=>$.isOpen,n=>{n||(a.value={username:"",password:"",name:""},u.value="",x.value=!1)});const f=n=>{if(!n)return{score:0,percentage:0,label:"",color:"",textColor:""};let t=0;const r={length:n.length>=8,lowercase:/[a-z]/.test(n),uppercase:/[A-Z]/.test(n),numbers:/[0-9]/.test(n),special:/[^a-zA-Z0-9]/.test(n)};r.length&&(t+=1),r.lowercase&&(t+=1),r.uppercase&&(t+=1),r.numbers&&(t+=1),r.special&&(t+=1),n.length>=12&&(t+=1),n.length>=16&&(t+=1);let c="",g="",o="",h=0;return t<=2?(c="Weak",g="bg-red-500",o="text-red-600 dark:text-red-400",h=33):t<=4?(c="Fair",g="bg-yellow-500",o="text-yellow-600 dark:text-yellow-400",h=66):t<=6?(c="Good",g="bg-blue-500",o="text-blue-600 dark:text-blue-400",h=85):(c="Strong",g="bg-green-500",o="text-green-600 dark:text-green-400",h=100),{score:t,percentage:h,label:c,color:g,textColor:o}},l=I(()=>f(a.value.password)),d=()=>{_("close")},s=async()=>{if(!a.value.username.trim()||!a.value.password.trim()){u.value="Username and password are required";return}if(a.value.password.length<8){u.value="Password must be at least 8 characters";return}k.value=!0,u.value="";try{await T.createUser({username:a.value.username.trim(),password:a.value.password,name:a.value.name.trim()||void 0}),w.success("User created successfully"),_("created"),d()}catch(n){console.error("Error creating user:",n),u.value=n.message||"Failed to create user",w.error(n.message||"Failed to create user")}finally{k.value=!1}};return(n,t)=>(i(),E(y(O),{show:n.isOpen,as:"template"},{default:v(()=>[p(y(P),{as:"div",class:"relative z-50",onClose:d},{default:v(()=>[p(y(z),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:v(()=>t[4]||(t[4]=[e("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity"},null,-1)])),_:1}),e("div",je,[e("div",De,[p(y(z),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:v(()=>[p(y(q),{class:"w-full max-w-md overflow-hidden rounded-xl bg-white dark:bg-gray-800 shadow-2xl transform transition-all"},{default:v(()=>[e("div",ze,[p(y(H),{class:"text-xl font-semibold text-gray-900 dark:text-white"},{default:v(()=>t[5]||(t[5]=[U(" Add New User ")])),_:1}),e("button",{onClick:d,class:"rounded-lg p-2 text-gray-400 hover:bg-white/50 hover:text-gray-900 dark:hover:bg-gray-700 dark:hover:text-white transition-all duration-200"},t[6]||(t[6]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("form",{onSubmit:G(s,["prevent"]),class:"px-6 py-4"},[e("div",Te,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"},[U(" Username "),e("span",{class:"text-red-500"},"*")],-1)),D(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>a.value.username=r),type:"text",placeholder:"Enter username",required:"",class:"w-full rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-gray-900 placeholder-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-800 dark:text-white dark:placeholder-gray-500 dark:focus:border-brand-800 transition-all duration-200"},null,512),[[L,a.value.username]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"},[U(" Password "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Ee,[D(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>a.value.password=r),type:x.value?"text":"password",placeholder:"Enter password (min 8 characters)",required:"",minlength:"8",class:"w-full rounded-lg border border-gray-300 bg-white px-4 py-2.5 pr-11 text-gray-900 placeholder-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-800 dark:text-white dark:placeholder-gray-500 dark:focus:border-brand-800 transition-all duration-200"},null,8,Be),[[R,a.value.password]]),e("button",{type:"button",onClick:t[2]||(t[2]=r=>x.value=!x.value),class:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors"},[x.value?(i(),m("svg",Le,t[8]||(t[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)]))):(i(),m("svg",Ve,t[9]||(t[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])))])]),a.value.password?(i(),m("div",Ne,[e("div",Fe,[e("div",Pe,[e("div",{class:A(["h-full transition-all duration-300 rounded-full",l.value.color]),style:Z({width:l.value.percentage+"%"})},null,6)]),e("span",{class:A(["text-xs font-medium",l.value.textColor])},C(l.value.label),3)]),t[10]||(t[10]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," Minimum 8 characters ",-1))])):(i(),m("p",qe," Minimum 8 characters "))]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," Name (Optional) ",-1)),D(e("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>a.value.name=r),type:"text",placeholder:"Enter full name",class:"w-full rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-gray-900 placeholder-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-800 dark:text-white dark:placeholder-gray-500 dark:focus:border-brand-800 transition-all duration-200"},null,512),[[L,a.value.name]])]),u.value?(i(),m("div",He,[e("p",Oe,C(u.value),1)])):W("",!0)]),e("div",Ie,[e("button",{type:"button",onClick:d,class:"rounded-lg bg-gray-200 px-5 py-2.5 text-gray-900 font-medium hover:bg-gray-300 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 transition-all duration-200 shadow-sm hover:shadow"}," Cancel "),e("button",{type:"submit",disabled:k.value||!a.value.username.trim()||!a.value.password.trim()||a.value.password.length<8,class:"rounded-lg bg-brand-500 px-5 py-2.5 text-white font-medium hover:bg-brand-600 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800 transition-all duration-200 shadow-md hover:shadow-lg"},[k.value?(i(),m("span",Re,t[13]||(t[13]=[e("svg",{class:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),U(" Creating... ")]))):(i(),m("span",Ze,"Create User"))],8,Ge)])],32)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]))}}),Ye={class:"fixed inset-0 overflow-y-auto"},Ke={class:"flex min-h-full items-center justify-center p-4"},Je={class:"flex items-center justify-between border-b border-gray-200 dark:border-gray-700 px-6 py-4 bg-gradient-to-r from-brand-50 to-white dark:from-gray-800 dark:to-gray-800"},Qe={class:"space-y-4"},Xe={class:"relative"},et=["type","minlength"],tt={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},rt={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},at={key:0,class:"mt-2"},st={class:"flex items-center gap-2 mb-1"},ot={class:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden dark:bg-gray-700"},lt={key:1,class:"mt-1 text-xs text-gray-500 dark:text-gray-400"},nt={key:0,class:"rounded-lg bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 px-4 py-3"},dt={class:"text-sm text-red-800 dark:text-red-300"},it={class:"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700"},ut=["disabled"],ct={key:0,class:"flex items-center gap-2"},gt={key:1},pt=V({__name:"EditUserModal",props:{isOpen:{type:Boolean},editingUser:{}},emits:["close","updated"],setup(S,{emit:M}){const $=S,_=M,w=F(),a=b({name:"",email:"",password:""}),k=b(!1),u=b(""),x=b(!1),f=()=>{a.value={name:"",email:"",password:""},u.value="",x.value=!1};B(()=>$.editingUser,t=>{t?a.value={name:t.name,email:t.email,password:""}:f()},{immediate:!0}),B(()=>$.isOpen,t=>{t||f()});const l=t=>{if(!t)return{score:0,percentage:0,label:"",color:"",textColor:""};let r=0;const c={length:t.length>=8,lowercase:/[a-z]/.test(t),uppercase:/[A-Z]/.test(t),numbers:/[0-9]/.test(t),special:/[^a-zA-Z0-9]/.test(t)};c.length&&(r+=1),c.lowercase&&(r+=1),c.uppercase&&(r+=1),c.numbers&&(r+=1),c.special&&(r+=1),t.length>=12&&(r+=1),t.length>=16&&(r+=1);let g="",o="",h="",j=0;return r<=2?(g="Weak",o="bg-red-500",h="text-red-600 dark:text-red-400",j=33):r<=4?(g="Fair",o="bg-yellow-500",h="text-yellow-600 dark:text-yellow-400",j=66):r<=6?(g="Good",o="bg-blue-500",h="text-blue-600 dark:text-blue-400",j=85):(g="Strong",o="bg-green-500",h="text-green-600 dark:text-green-400",j=100),{score:r,percentage:j,label:g,color:o,textColor:h}},d=I(()=>l(a.value.password)),s=()=>{_("close")},n=async()=>{if(!a.value.name.trim()||!a.value.email.trim()){u.value="Name and email are required";return}if(a.value.password&&a.value.password.length<8){u.value="Password must be at least 8 characters";return}if($.editingUser){k.value=!0,u.value="";try{const t={name:a.value.name.trim(),email:a.value.email.trim()};a.value.password.trim()&&(t.password=a.value.password),await T.updateUser($.editingUser._id,t),w.success("User updated successfully"),_("updated"),s()}catch(t){console.error("Error updating user:",t),u.value=t.message||"Failed to update user",w.error(t.message||"Failed to update user")}finally{k.value=!1}}};return(t,r)=>(i(),E(y(O),{show:t.isOpen,as:"template"},{default:v(()=>[p(y(P),{as:"div",class:"relative z-50",onClose:s},{default:v(()=>[p(y(z),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:v(()=>r[4]||(r[4]=[e("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity"},null,-1)])),_:1}),e("div",Ye,[e("div",Ke,[p(y(z),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:v(()=>[p(y(q),{class:"w-full max-w-md overflow-hidden rounded-xl bg-white dark:bg-gray-800 shadow-2xl transform transition-all"},{default:v(()=>[e("div",Je,[p(y(H),{class:"text-xl font-semibold text-gray-900 dark:text-white"},{default:v(()=>r[5]||(r[5]=[U(" Edit User ")])),_:1}),e("button",{onClick:s,class:"rounded-lg p-2 text-gray-400 hover:bg-white/50 hover:text-gray-900 dark:hover:bg-gray-700 dark:hover:text-white transition-all duration-200"},r[6]||(r[6]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("form",{onSubmit:G(n,["prevent"]),class:"px-6 py-4"},[e("div",Qe,[e("div",null,[r[7]||(r[7]=e("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"},[U(" Name "),e("span",{class:"text-red-500"},"*")],-1)),D(e("input",{"onUpdate:modelValue":r[0]||(r[0]=c=>a.value.name=c),type:"text",placeholder:"Enter full name",required:"",class:"w-full rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-gray-900 placeholder-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-800 dark:text-white dark:placeholder-gray-500 dark:focus:border-brand-800 transition-all duration-200"},null,512),[[L,a.value.name]])]),e("div",null,[r[8]||(r[8]=e("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"},[U(" Email/Username "),e("span",{class:"text-red-500"},"*")],-1)),D(e("input",{"onUpdate:modelValue":r[1]||(r[1]=c=>a.value.email=c),type:"email",placeholder:"Enter email",required:"",class:"w-full rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-gray-900 placeholder-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-800 dark:text-white dark:placeholder-gray-500 dark:focus:border-brand-800 transition-all duration-200"},null,512),[[L,a.value.email]])]),e("div",null,[r[12]||(r[12]=e("label",{class:"block text-sm font-medium text-gray-900 dark:text-white mb-2"}," New Password ",-1)),e("div",Xe,[D(e("input",{"onUpdate:modelValue":r[2]||(r[2]=c=>a.value.password=c),type:x.value?"text":"password",placeholder:"Leave empty to keep current password",minlength:a.value.password?8:0,class:"w-full rounded-lg border border-gray-300 bg-white px-4 py-2.5 pr-11 text-gray-900 placeholder-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-800 dark:text-white dark:placeholder-gray-500 dark:focus:border-brand-800 transition-all duration-200"},null,8,et),[[R,a.value.password]]),e("button",{type:"button",onClick:r[3]||(r[3]=c=>x.value=!x.value),class:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors"},[x.value?(i(),m("svg",tt,r[9]||(r[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"},null,-1)]))):(i(),m("svg",rt,r[10]||(r[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])))])]),a.value.password?(i(),m("div",at,[e("div",st,[e("div",ot,[e("div",{class:A(["h-full transition-all duration-300 rounded-full",d.value.color]),style:Z({width:d.value.percentage+"%"})},null,6)]),e("span",{class:A(["text-xs font-medium",d.value.textColor])},C(d.value.label),3)]),r[11]||(r[11]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," Minimum 8 characters ",-1))])):(i(),m("p",lt," Minimum 8 characters. Leave empty to keep current password. "))]),u.value?(i(),m("div",nt,[e("p",dt,C(u.value),1)])):W("",!0)]),e("div",it,[e("button",{type:"button",onClick:s,class:"rounded-lg bg-gray-200 px-5 py-2.5 text-gray-900 font-medium hover:bg-gray-300 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 transition-all duration-200 shadow-sm hover:shadow"}," Cancel "),e("button",{type:"submit",disabled:!!(k.value||!a.value.name.trim()||!a.value.email.trim()||a.value.password&&a.value.password.length<8),class:"rounded-lg bg-brand-500 px-5 py-2.5 text-white font-medium hover:bg-brand-600 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed dark:focus:ring-offset-gray-800 transition-all duration-200 shadow-md hover:shadow-lg"},[k.value?(i(),m("span",ct,r[13]||(r[13]=[e("svg",{class:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),U(" Updating... ")]))):(i(),m("span",gt,"Update User"))],8,ut)])],32)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]))}}),mt={class:"space-y-5 sm:space-y-6"},ft={class:"mb-4 flex justify-end"},yt={class:"fixed inset-0 overflow-y-auto"},vt={class:"flex min-h-full items-center justify-center p-4"},xt={class:"px-6 py-4"},bt={class:"text-sm text-gray-600 dark:text-gray-400 mb-4"},ht={class:"flex justify-end gap-3"},kt=["disabled"],wt={key:0,class:"flex items-center gap-2"},_t={key:1},zt=V({__name:"ManagementUsers",setup(S){const M=b("Management Users"),$=b(!1),_=b(!1),w=b(!1),a=b(null),k=b(null),u=b(!1),x=b(0),f=b(null),l=F(),d=()=>{x.value+=1,f.value&&f.value.refresh&&f.value.refresh()},s=g=>{a.value=g,_.value=!0},n=()=>{x.value+=1,f.value&&f.value.refresh&&f.value.refresh()},t=async g=>{try{await T.toggleUserStatus(g._id,!g.isActive),l.success(`User ${g.isActive?"deactivated":"activated"} successfully`),x.value+=1,f.value&&f.value.refresh&&f.value.refresh()}catch(o){console.error("Error toggling user status:",o),l.error(o.message||"Failed to update user status")}},r=g=>{k.value=g,w.value=!0},c=async()=>{if(k.value){u.value=!0;try{await T.deleteUser(k.value._id),l.success("User deleted successfully"),w.value=!1,k.value=null,x.value+=1,f.value&&f.value.refresh&&f.value.refresh()}catch(g){console.error("Error deleting user:",g),l.error(g.message||"Failed to delete user")}finally{u.value=!1}}};return(g,o)=>(i(),E(K,null,{default:v(()=>[p(Y,{pageTitle:M.value},null,8,["pageTitle"]),e("div",mt,[p(J,{title:"Management Users"},{default:v(()=>[e("div",ft,[e("button",{onClick:o[0]||(o[0]=h=>$.value=!0),class:"flex items-center gap-2 rounded-lg bg-brand-500 px-4 py-2.5 text-white font-medium hover:bg-brand-600 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition-all duration-200 shadow-md hover:shadow-lg"},o[5]||(o[5]=[e("svg",{class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),U(" Add User ")]))]),p(Se,{"refresh-trigger":x.value,ref_key:"tableRef",ref:f,onEdit:s,onToggleStatus:t,onDelete:r},null,8,["refresh-trigger"])]),_:1})]),p(We,{"is-open":$.value,onClose:o[1]||(o[1]=h=>$.value=!1),onCreated:d},null,8,["is-open"]),p(pt,{"is-open":_.value,"editing-user":a.value,onClose:o[2]||(o[2]=h=>_.value=!1),onUpdated:n},null,8,["is-open","editing-user"]),p(y(O),{show:w.value,as:"template"},{default:v(()=>[p(y(P),{as:"div",class:"relative z-50",onClose:o[4]||(o[4]=h=>w.value=!1)},{default:v(()=>[p(y(z),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:v(()=>o[6]||(o[6]=[e("div",{class:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity"},null,-1)])),_:1}),e("div",yt,[e("div",vt,[p(y(z),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:v(()=>[p(y(q),{class:"w-full max-w-md overflow-hidden rounded-xl bg-white dark:bg-gray-800 shadow-2xl transform transition-all"},{default:v(()=>{var h;return[e("div",xt,[p(y(H),{class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},{default:v(()=>o[7]||(o[7]=[U(" Delete User ")])),_:1}),e("p",bt,' Are you sure you want to delete the user "'+C((h=k.value)==null?void 0:h.name)+'"? This action cannot be undone. ',1),e("div",ht,[e("button",{onClick:o[3]||(o[3]=j=>w.value=!1),class:"rounded-lg bg-gray-200 px-4 py-2 text-gray-900 font-medium hover:bg-gray-300 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600 transition-all"}," Cancel "),e("button",{onClick:c,disabled:u.value,class:"rounded-lg bg-red-500 px-4 py-2 text-white font-medium hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all"},[u.value?(i(),m("span",wt,o[8]||(o[8]=[e("svg",{class:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),U(" Deleting... ")]))):(i(),m("span",_t,"Delete"))],8,kt)])])]}),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"])]),_:1}))}});export{zt as default};
